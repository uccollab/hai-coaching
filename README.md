# HAI-coaching
Official repository for HAI-coaching, the first high quality dataset for nutritional counselling, sourced through Human-AI (HAI) collaboration.

# WARNING: READ CAREFULLY
This dataset has not been published yet, so every use of it is subject to individual approval and must be kept confidential. Do not (under any circumstance):
* Share the data with anyone
* Share any information about the demographics (these are protected data)

Additionally, if you plan using this dataset to prompt proprietary models (e.g. Google's Bard, OpenAI's ChatGPT etc.) always consult the owner (Simone Balloccu) before, to avoid data leaking. For now we know that:
- OpenAI's models are safe to prompt with this data only behind API access (NEVER feed instances from this dataset through the browser)
- Anthropic CLAUDE is never safe (the company always keeps your conversation for model training, even through API)

## Intro
> Large Language Models (LLMs), with their flexibility, can be powerful tools for data generation in low-resource domains but problems like hallucinations and biases limit such applications. In this work, we show how high-quality datasets can be gathered through Human-AI (HAI) collaboration. For nutrition counselling, a domain lacking any public corpus or dataset, we use a combination of crowd-workers, ChatGPT and nutrition experts to generate appropriate data and evaluate if the model can safely support people with their dietary issues. As result, we release HAI-coaching, the first nutrition counseling dataset containing ~2.4K dietary struggles from crowd workers, and ~80K related supportive texts generated by ChatGPT, all evaluated by nutrition experts.

## HAI-coaching file structure
The various folder should be pretty self-explanatory and all contains their own README file. The dataset itself is in the  ``dataset.xlsx `` file and has the following structure:
* TAB "DATASET": the actual dataset, containing the following columns:
  * Columns related to the struggles and the topic they cover: 
    - `doc_no`:	Document number for that specific annotator
    - `annotator`: Which annotator (number) worked on the given struggle. If "ALL", then the struggle was used for IAA, hence annotated by everyone.	
    - `struggle`:	The struggle, after typo correction.
    - `cluster_auto`:	Coarse clustering, obtained automatically. Hyperparameters were set to capture main topics. Has been used as an aiding tool during topic modelling with experts.	
    - `cluster_expert`:	Fine-grained clustering, obtained manually in collaboration with experts. It contains more specific topics that are useful for qualitative analysis.	
    - `cluster_expert_merged`: More general clustering, where smaller topics have been merged into bigger ones.
    - `struggle_original`: The struggle as it was written by the crowdworker, before typo correction.	
    - `full_embeddings`: Embeddings for the struggle, from all-mpnet model. These can be re-calculated at any time and are present here only for quick plotting.
    - `reduced_embeddings`:	Embeddings after PCA, for 3D plotting purposes.
    			
  * Candidates from ChatGPT and their annotation. For IAA, majority voting was used. 
      - `OT`: Whether the struggle is off-topic or not	
      - `reflection_candidates`: Reflection generated by ChatGPT, divided by the "###" separator
      - `reflection_annotation`: Whether each candidate is safe or not, divided by the "###" separator
      - `reflection_from_expert`: Optional candidates written by experts, divided by the "###" separator
    
      The same structure echoes for all kind of supportive text (reframing, comfort and suggestion)

* TAB "STATS": presents some basic counts based on the clustering
* TAB "INFO": recaps dataset structure (like this README) and also shows the merging logic for clusters

  * Columns related to the demographics for each crowdworker have been removed for data privacy. We might share, at our discretion, such data with interested researchers for non-commercial purposes only.   


## Working with the dataset
The file ``dataset_parsing.ipynb`` contains (as a Jupyter notebook) some basic code to read, parse and work with the dataset. 
